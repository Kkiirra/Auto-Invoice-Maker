{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load static i18n %}
{% block navprofiledash %}
    here
{% endblock navprofiledash %}

{% block content %}
<!--begin::Main-->
<div class="app-main flex-column flex-row-fluid" id="kt_app_main">
    <!--begin::Content wrapper-->
    <div class="d-flex flex-column flex-column-fluid">
		<!--begin::Toolbar-->
		<div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
			<!--begin::Toolbar container-->
			<div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
				<!--begin::Page title-->
				<div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
					<!--begin::Title-->
					<h1 class="page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0">Finance Performance</h1>
					<!--end::Title-->
					<!--begin::Breadcrumb-->
					<ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
						<!--begin::Item-->
						<li class="breadcrumb-item text-muted">Dashboard</li>
						<!--end::Item-->
					</ul>
					<!--end::Breadcrumb-->
				</div>
				<!--end::Page title-->
				<!--begin::Actions-->
				<div class="d-flex align-items-center gap-2 gap-lg-3">
					<!--begin::Daterangepicker(defined in src/js/layout/app.js)-->
					<div data-kt-daterangepicker="true" data-kt-daterangepicker-opens="left" class="btn btn-sm fw-bold bg-body btn-color-gray-700 btn-active-color-primary d-flex align-items-center px-4" data-kt-initialized="1">
											<!--begin::Display range-->
<!--                                            <input type="text" name="daterange" id="daterange" class="form-control"/>-->
                                            <div id="reportrange" class="text-gray-600 fw-bold">
                                                <i class="fa fa-calendar"></i>&nbsp;
                                                <span></span></i>
                                            </div>

										</div>
					<!--end::Daterangepicker-->
					<!--begin::Secondary button-->
					<!--end::Secondary button-->
				</div>
				<!--end::Actions-->
			</div>
			<!--end::Toolbar container-->
		</div>
		<!--end::Toolbar-->
        <!--begin::Content-->
        <div id="kt_app_content" class="app-content flex-column-fluid">
            <!--begin::Content container-->
            <div id="kt_app_content_container" class="app-container container-xxl">
				<!--begin::Chart widget 20-->
				<div class="card card-flush h-xl-50" style="margin-bottom:50px">
												<!--begin::Header-->
												<div class="card-header py-5">
													<!--begin::Title-->
													<h3 class="card-title fw-bold text-gray-800">Sales Analytics</h3>
													<!--end::Title-->

												</div>
												<!--end::Header-->
												<!--begin::Card body-->
												<div class="card-body d-flex justify-content-between flex-column pb-0 px-0 pt-1">
													<!--begin::Items-->
													<div class="d-flex flex-wrap d-grid gap-5 px-9 mb-5">
														<!--begin::Item-->
														<div class="me-md-2">
															<!--begin::Statistics-->
															<div class="d-flex mb-2">
																<span class="fs-4 fw-semibold text-gray-400 me-1">$</span>
																<span class="fs-2hx fw-bold text-gray-800 me-2 lh-1 ls-n2">{{ amount_of_income }}</span>
															</div>
															<!--end::Statistics-->
															<!--begin::Description-->
															<span class="fs-6 fw-semibold text-gray-400">Amount of income</span>
															<!--end::Description-->
														</div>
														<!--end::Item-->
														<!--begin::Item-->
														<div class="border-start-dashed border-end-dashed border-1 border-gray-300 px-5 ps-md-10 pe-md-7 me-md-5">
															<!--begin::Statistics-->
															<div class="d-flex mb-2">
																<span class="fs-4 fw-semibold text-gray-400 me-1">$</span>
																<span class="fs-2hx fw-bold text-gray-800 me-2 lh-1 ls-n2">{{ amount_of_expenses }}</span>
															</div>
															<!--end::Statistics-->
															<!--begin::Description-->
															<span class="fs-6 fw-semibold text-gray-400">Amount of disposal</span>
															<!--end::Description-->
														</div>
														<!--end::Item-->
														<!--begin::Item-->
														<div class="m-0">
															<!--begin::Statistics-->
															<div class="d-flex align-items-center mb-2">
																<!--begin::Currency-->
																<span class="fs-4 fw-semibold text-gray-400 align-self-start me-1">$</span>
																<!--end::Currency-->
																<!--begin::Value-->
																<span class="fs-2hx fw-bold text-gray-800 me-2 lh-1 ls-n2">{{ gap }}</span>
																<!--end::Value-->
																<!--begin::Label-->
																{% if amount_of_income > amount_of_expenses %}
																<span class="badge badge-light-success fs-base">
																<!--begin::Svg Icon | path: icons/duotune/arrows/arr067.svg-->
																<span class="svg-icon svg-icon-7 svg-icon-success ms-n1">
																	<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
																		<path opacity="0.5" d="M13 9.59998V21C13 21.6 12.6 22 12 22C11.4 22 11 21.6 11 21V9.59998H13Z" fill="currentColor" />
																		<path d="M5.7071 7.89291C5.07714 8.52288 5.52331 9.60002 6.41421 9.60002H17.5858C18.4767 9.60002 18.9229 8.52288 18.2929 7.89291L12.7 2.3C12.3 1.9 11.7 1.9 11.3 2.3L5.7071 7.89291Z" fill="currentColor" />
																	</svg>
																</span>

																	<!--end::Svg Icon-->{{gap_procent}}%</span>
																{% else %}
																<span class="badge badge-light-danger fs-base">
													<!--begin::Svg Icon | path: icons/duotune/arrows/arr065.svg-->
													<span class="svg-icon svg-icon-5 svg-icon-danger ms-n1">
														<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
															<rect opacity="0.5" x="11" y="18" width="13" height="2" rx="1" transform="rotate(-90 11 18)" fill="currentColor"></rect>
															<path d="M11.4343 15.4343L7.25 11.25C6.83579 10.8358 6.16421 10.8358 5.75 11.25C5.33579 11.6642 5.33579 12.3358 5.75 12.75L11.2929 18.2929C11.6834 18.6834 12.3166 18.6834 12.7071 18.2929L18.25 12.75C18.6642 12.3358 18.6642 11.6642 18.25 11.25C17.8358 10.8358 17.1642 10.8358 16.75 11.25L12.5657 15.4343C12.2533 15.7467 11.7467 15.7467 11.4343 15.4343Z" fill="currentColor"></path>
														</svg>
													</span>
													<!--end::Svg Icon-->{{ gap_procent }}%</span>
																{% endif %}
																<!--end::Label-->
															</div>
															<!--end::Statistics-->
															<!--begin::Description-->
															<span class="fs-6 fw-semibold text-gray-400">Balance</span>
															<!--end::Description-->
														</div>
														<!--end::Item-->
													</div>
													<!--end::Items-->
													<!--begin::Chart-->
													<div id="kt_charts_widget_36" class="min-h-auto ps-4 pe-6" data-kt-chart-info="Revenue" style="height: 300px"></div>
													<!--end::Chart-->
												</div>
												<!--end::Card body-->
											</div>
				<!--end::Chart widget 20-->
				<!--begin::Chart widget 20-->
				<div class="card card-flush h-xl-50">
												<!--begin::Header-->
												<div class="card-header py-5">
													<!--begin::Title-->
													<h3 class="card-title fw-bold text-gray-800">Cashflow analytics</h3>
													<!--end::Title-->
												</div>
												<!--end::Header-->
												<!--begin::Card body-->
												<div class="card-body d-flex justify-content-between flex-column pb-0 px-0 pt-1">
													<!--begin::Items-->
													<div class="d-flex flex-wrap d-grid gap-5 px-9 mb-5">
														<!--begin::Item-->
														<div class="me-md-2">
															<!--begin::Statistics-->
															<div class="d-flex mb-2">
																<span class="fs-4 fw-semibold text-gray-400 me-1">$</span>
																<span class="fs-2hx fw-bold text-gray-800 me-2 lh-1 ls-n2">{{ total_order_value|floatformat:2 }}</span>
															</div>
															<!--end::Statistics-->
															<!--begin::Description-->
															<span class="fs-6 fw-semibold text-gray-400">Total order value</span>
															<!--end::Description-->
														</div>
														<!--end::Item-->
														<!--begin::Item-->
														<div class="border-start-dashed border-end-dashed border-1 border-gray-300 px-5 ps-md-10 pe-md-7 me-md-5">
															<!--begin::Statistics-->
															<div class="d-flex mb-2">
																<span class="fs-4 fw-semibold text-gray-400 me-1">$</span>
																<span class="fs-2hx fw-bold text-gray-800 me-2 lh-1 ls-n2">{{ average_order_value|floatformat:2 }}</span>
															</div>
															<!--end::Statistics-->
															<!--begin::Description-->
															<span class="fs-6 fw-semibold text-gray-400">Average order value</span>
															<!--end::Description-->
														</div>
														<!--end::Item-->

													</div>
													<!--end::Items-->
													<!--begin::Chart-->
													<div id="kt_charts_widget_20" class="min-h-auto ps-4 pe-6" data-kt-chart-info="Order" style="height: 300px"></div>
													<!--end::Chart-->
												</div>
												<!--end::Card body-->
											</div>
				<!--end::Chart widget 20-->
            </div>
            <!--end::Content container-->
        </div>
        <!--end::Content-->
    </div>
    <!--end::Content wrapper-->

</div>
<!--end:::Main-->
{% endblock content %}
{% block scripts %}
<script>
	var KTChartsWidget36 = function() {
	var e = {
			self: null,
			rendered: !1
		},
		t = function(e) {
			var t = document.getElementById("kt_charts_widget_36");
			if (t) {
				var a = parseInt(KTUtil.css(t, "height")),
					l = KTUtil.getCssVariableValue("--kt-gray-500"),
					r = KTUtil.getCssVariableValue("--kt-border-dashed-color"),
					o = KTUtil.getCssVariableValue("--kt-danger"),
					i = KTUtil.getCssVariableValue("--kt-danger"),
					s = KTUtil.getCssVariableValue("--kt-success"),
					n = {
						series: [{

							name: "Amount of  Income",
							data: [
							{% for income_transaction in income_transactions.values %}
							{{ income_transaction }},
							{% endfor %}
							]
						}, {
							name: "Amount of Disposal",
							data: [
							{% for expenses_transaction in expenses_transactions.values %}
							{{ expenses_transaction }},
							{% endfor %}
							]
						}],
						chart: {
							fontFamily: "inherit",
							type: "area",
							height: a,
							toolbar: {
								show: !1
							}
						},
						plotOptions: {},
						legend: {
							show: !1
						},
						dataLabels: {
							enabled: !1
						},
						fill: {
							type: "gradient",
							gradient: {
								shadeIntensity: 1,
								opacityFrom: .4,
								opacityTo: .2,
								stops: [15, 120, 100]
							}
						},
						stroke: {
							curve: "smooth",
							show: !0,
							width: 3,
							colors: [o, s]
						},
						xaxis: {
							categories: ["",
							{% for income_transaction in income_transactions.keys %}
							"{{income_transaction}}",
							{% endfor %}
							],
							axisBorder: {
								show: !1
							},
							axisTicks: {
								show: !1
							},
							tickAmount: 6,
							labels: {
								rotate: 0,
								rotateAlways: !0,
								style: {
									colors: l,
									fontSize: "12px"
								}
							},
							crosshairs: {
								position: "front",
								stroke: {
									color: [o, s],
									width: 1,
									dashArray: 3
								}
							},
							tooltip: {
								enabled: !0,
								formatter: void 0,
								offsetY: 0,
								style: {
									fontSize: "12px"
								}
							}
						},
						yaxis: {
							max: {{ max_transaction }},
							min: 0,
							tickAmount: 6,
							labels: {
								style: {
									colors: l,
									fontSize: "12px"
								}
							}
						},
						states: {
							normal: {
								filter: {
									type: "none",
									value: 0
								}
							},
							hover: {
								filter: {
									type: "none",
									value: 0
								}
							},
							active: {
								allowMultipleDataPointsSelection: !1,
								filter: {
									type: "none",
									value: 0
								}
							}
						},
						tooltip: {
							style: {
								fontSize: "12px"
							}
						},
						colors: [i, KTUtil.getCssVariableValue("--kt-success")],
						grid: {
							borderColor: r,
							strokeDashArray: 4,
							yaxis: {
								lines: {
									show: !0
								}
							}
						},
						markers: {
							strokeColor: [o, s],
							strokeWidth: 3
						}
					};
				e.self = new ApexCharts(t, n), setTimeout((function() {
					e.self.render(), e.rendered = !0
				}), 200)
			}
		};
	return {
		init: function() {
			t(e), KTThemeMode.on("kt.thememode.change", (function() {
				e.rendered && e.self.destroy(), t(e)
			}))
		}
	}
}();
KTChartsWidget36.init()
</script>
<script>
	var KTChartsWidget20 = function() {
	var e = {
			self: null,
			rendered: !1
		},
		t = function(e) {
			var t = document.getElementById("kt_charts_widget_20");
			if (t) {
				var a = parseInt(KTUtil.css(t, "height")),
					l = KTUtil.getCssVariableValue("--kt-gray-500"),
					r = KTUtil.getCssVariableValue("--kt-border-dashed-color"),
					o = KTUtil.getCssVariableValue("--kt-primary"),
					i = KTUtil.getCssVariableValue("--kt-primary"),
					s = {
						series: [{
							name: t.getAttribute("data-kt-chart-info"),
							data: [
							{% for order in order_val_dict.values %}
 							"{{ order }}",
 							{% endfor %}
							]
						}],
						chart: {
							fontFamily: "inherit",
							type: "area",
							height: a,
							toolbar: {
								show: !1
							}
						},
						plotOptions: {},
						legend: {
							show: !1
						},
						dataLabels: {
							enabled: !1
						},
						fill: {
							type: "gradient",
							gradient: {
								shadeIntensity: 1,
								opacityFrom: .4,
								opacityTo: 0,
								stops: [0, 80, 100]
							}
						},
						stroke: {
							curve: "smooth",
							show: !0,
							width: 3,
							colors: [i]
						},
						xaxis: {
							categories: ["",
							{% for order_date in order_val_dict.keys %}
							"{{ order_date }}",
							{% endfor %}
							 ""],
							axisBorder: {
								show: !1
							},
							axisTicks: {
								show: !1
							},
							tickAmount: 6,
							labels: {
								rotate: 0,
								rotateAlways: !0,
								style: {
									colors: l,
									fontSize: "12px"
								}
							},
							crosshairs: {
								position: "front",
								stroke: {
									color: o,
									width: 1,
									dashArray: 3
								}
							},
							tooltip: {
								enabled: !0,
								formatter: void 0,
								offsetY: 0,
								style: {
									fontSize: "12px"
								}
							}
						},
						yaxis: {
							max: {{ max_order }},
							min: 0,
							tickAmount: 6,
							labels: {
								style: {
									colors: l,
									fontSize: "12px"
								},
							}
						},
						states: {
							normal: {
								filter: {
									type: "none",
									value: 0
								}
							},
							hover: {
								filter: {
									type: "none",
									value: 0
								}
							},
							active: {
								allowMultipleDataPointsSelection: !1,
								filter: {
									type: "none",
									value: 0
								}
							}
						},
						tooltip: {
							style: {
								fontSize: "12px"
							},
							y: {
							}
						},
						colors: [i],
						grid: {
							borderColor: r,
							strokeDashArray: 4,
							yaxis: {
								lines: {
									show: !0
								}
							}
						},
						markers: {
							strokeColor: o,
							strokeWidth: 3
						}
					};
				e.self = new ApexCharts(t, s), setTimeout((function() {
					e.self.render(), e.rendered = !0
				}), 200)
			}
		};
	return {
		init: function() {
			t(e), KTThemeMode.on("kt.thememode.change", (function() {
				e.rendered && e.self.destroy(), t(e)
			}))
		}
	}
}();
KTChartsWidget20.init()
</script>
<script>
$(function() {
    var start = moment().startOf('month');
    var end = moment();

    function cb(start, end) {
        $('#reportrange span').html(start.format('DD.MM.YYYY') + ' - ' + end.format('DD.MM.YYYY'));
    }

    $('#reportrange').daterangepicker({
        startDate: start,
        endDate: end,
        maxDate: moment().format('MM.DD.YYYY'),
        locale: {
            format: 'MM.DD.YYYY',
            },
        ranges: {
           'Last 7 Days': [moment().subtract(6, 'days'), moment()],
           'Last 30 Days': [moment().subtract(29, 'days'), moment()],
           'This Month': [moment().startOf('month'), moment().endOf('month')],
           'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
        }
    }, cb);
    cb(start, end);
});
</script>
<script>
    $('#reportrange').on('apply.daterangepicker', function(ev, picker) {
    window.location.href = "/" + "dashboard" + "/" + picker.startDate.format('DD.MM.YYYY') + "-" + picker.endDate.format('DD.MM.YYYY') + "/"
            });
</script>
{% endblock scripts %}